<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/security
	http://www.springframework.org/schema/security/spring-security.xsd">

	<!-- Security 2.0 Spring (Migrating from acegi) -->
	
	<http pattern="/api/workflow/**" use-expressions="true"
		auto-config="true" disable-url-rewriting="false"
		entry-point-ref="restAuthenticationEntryPoint"
		access-decision-manager-ref="accessDecisionManager">

		 <!-- enable remember me 
		    <remember-me key="spring-sec"
		    services-ref="rememberMeServices"/>--><!--  token-validity-seconds="1209600" data-source-ref="dataSource"  remember-me-parameter="remember-me" -->
		 <remember-me key="jsfspring-sec" services-ref="rememberMeServices"/>
		 
		<!-- <remember-me user-service-ref="restService" token-repository-ref="tokenRepository" token-validity-seconds="86400" />-->
		<!-- <remember-me key="some_random_key" 
         token-validity-seconds="31536000" 
         user-service-ref="restService" token-repository-ref="tokenRepository" />
         -->
       
			
		<!-- authentication-success-handler-ref="mySuccessHandler" authentication-failure-handler-ref="myFailureHandler" 
		<logout logout-url="/security/logout.html" invalidate-session="true"
			delete-cookies="JSESSIONID,SPRING_SECURITY_REMEMBER_ME_COOKIE" success-handler-ref="myLogoutHandler" />-->
   		
		<form-login login-page="/api/workflow/login*" 
			username-parameter="username" password-parameter="password" 
			authentication-success-handler-ref="mySuccessHandler"
			authentication-failure-handler-ref="myFailureHandler" />
		<!-- authentication-success-handler-ref="mySuccessHandler" authentication-failure-handler-ref="myFailureHandler" -->
		<logout logout-url="/api/workflow/logout" invalidate-session="true"
			delete-cookies="JSESSIONID,SPRING_SECURITY_REMEMBER_ME_COOKIE" success-handler-ref="myLogoutHandler" />

		<!-- Rest Web Service -->

		<intercept-url pattern="/api/workflow/signInOut"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
		<intercept-url pattern="/api/workflow/userRequest"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
		<intercept-url pattern="/api/workflow/submittedRequests"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
		<intercept-url pattern="/api/workflow/vacInfo"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
		<intercept-url pattern="/api/workflow/editUserInfo"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />

		<intercept-url pattern="/api/workflow/requestsForApproval"
			access="hasRole('CAN_VIEW_page_requestsApproval')" />
			
		<intercept-url pattern="/api/workflow/approveRequest"
			access="hasRole('CAN_VIEW_page_requestsApproval')" />
			
		<intercept-url pattern="/api/workflow/vacTypes"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			
		<intercept-url pattern="/api/workflow/checkStartedRequests"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />

		<intercept-url pattern="/api/workflow/getSettings"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />

		<intercept-url pattern="/api/workflow/getRequestTypes"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			
			<intercept-url pattern="/api/workflow/getEmployeesByGroup"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			
			<intercept-url pattern="/api/workflow/getUserGroups"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			
			
			<intercept-url pattern="/api/workflow/insertTimesheetActivity"
			access="hasRole('CAN_VIEW_page_requestsApproval')" />
			<intercept-url pattern="/api/workflow/insertTimesheetPart"
			access="hasRole('CAN_VIEW_page_requestsApproval')" />
			<intercept-url pattern="/api/workflow/insertTimesheetCostcenter"
			access="hasRole('CAN_VIEW_page_requestsApproval')" />
			<intercept-url pattern="/api/workflow/insertTimesheetSpecs"
			access="hasRole('CAN_VIEW_page_requestsApproval')" />
			<intercept-url pattern="/api/workflow/insertTimesheetTransDefaults"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			<intercept-url pattern="/api/workflow/insertTimesheetTrans"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
						
			<intercept-url pattern="/api/workflow/getActivities"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			<intercept-url pattern="/api/workflow/getCostcenters"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			<intercept-url pattern="/api/workflow/getParts"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			<intercept-url pattern="/api/workflow/getTimesheetSpecs"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			<intercept-url pattern="/api/workflow/getTimesheetTrans"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
		<!--  <intercept-url pattern="/api/workflow/getPortNo" access="IS_AUTHENTICATED_ANONYMOUSLY"/> --> 
			
		<custom-filter ref="authenticationFilter" before="PRE_AUTH_FILTER" />
		<custom-filter ref="rememberMeFilter" before="REMEMBER_ME_FILTER"/>

		<access-denied-handler ref="exceptionControllerAdvice" />
		

	</http>
 
    <!--   <anonymous 
      granted-authority="ROLE_ANONYMOUS"
      key="123"
      username="anonymousUser"/> -->

 <beans:bean id="rememberMeServices"
      class="org.springframework.security.web.authentication.rememberme.PersistentTokenBasedRememberMeServices">
      
  <!--   <beans:property  name="userDetailsService" ref="restService" />
    <beans:property  name="tokenRepository" ref="tokenRepository" />
    <beans:property name="alwaysRemember" value="true"/>
    <beans:property name="cookieName" value="remember-me-cookie"/>
    <beans:property name="tokenLength" value="32"/>
     <beans:property name="tokenValiditySeconds" value="86400"/>
    <beans:property  name="key" value="spring-token" />-->

    <beans:constructor-arg name="key"  value="jsfspring-sec"/>
    <beans:constructor-arg name="userDetailsService" ref="restService"/> 
    <beans:constructor-arg  name="tokenRepository" ref="tokenRepository" />
    <beans:property name="alwaysRemember" value="true"/>
    <beans:property name="tokenValiditySeconds" value="8640000" />
</beans:bean>

<beans:bean id="tokenRepository"
      class="org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl">
      <beans:property name="dataSource" ref="dataSource"/>
</beans:bean>

 <beans:bean id="rememberMeAuthenticationProvider"
        class="org.springframework.security.authentication.RememberMeAuthenticationProvider">
      <!--   <beans:property name="key" value="jsfspring-sec"/>-->
      <beans:constructor-arg value="jsfspring-sec"/>
    </beans:bean>

    <beans:bean id="rememberMeFilter"
        class="org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter">
        <beans:constructor-arg ref="authenticationManager"/>
    	<beans:constructor-arg ref="rememberMeServices"/>
    </beans:bean>

	<http auto-config="true">
		<form-login 
			login-page="/security/login.html"
			login-processing-url="/security/perform_login"
			default-target-url="/security/defaultPage.html" 
			username-parameter="username" 
			password-parameter="password"
			authentication-failure-url="/security/login.html?failed=true"
			/>
			
		<logout logout-url="/security/logout.html"
			logout-success-url="/security/login.html" delete-cookies="JSESSIONID" />
		<!--<csrf disabled="true"/>-->
		
		<session-management>
			<concurrency-control max-sessions="10"
				error-if-maximum-exceeded="true" />
		</session-management>

		<intercept-url pattern="\A/common/commonAdminCountryCities.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminCountryCities" />
		<intercept-url pattern="\A/common/commonAdminEditCity.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminEditCity" />
		<intercept-url pattern="\A/common/commonAdminCountries.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminCountries" />
		<intercept-url pattern="\A/common/commonAdminEditCountry.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminEditCountry" />
		<intercept-url pattern="\A/common/commonAdminDepartments.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminDepartments" />
		<intercept-url pattern="\A/common/commonAdminEditDepartment.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminEditDepartment" />
		<intercept-url pattern="\A/common/commonAdminEmployees.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminEmployees" />
		<intercept-url pattern="\A/common/commonAdminEditEmployee.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminEditEmployee" />
		<intercept-url pattern="\A/common/commonAdminChangePassword.html.*\Z"
			access="CAN_VIEW_page_common_commonAdminChangePassword" />
		<intercept-url pattern="\A/common/commonAdminRegions.html.*\Z"
			access="CAN_VIEW_page_common_regionsView" />
		<intercept-url pattern="\A/common/commonAdminEditRegion.html.*\Z"
			access="CAN_VIEW_page_common_regionForm" />
			
		
		<intercept-url pattern="\A/i18n/editMessage.html.*\Z"
			access="CAN_VIEW_page_i18n_editMessage" />
		<intercept-url pattern="\A/i18n/changeDefaultLocale.html.*\Z"
			access="CAN_VIEW_page_i18n_changeDefaultLocale" />
		<intercept-url pattern="\A/i18n/addNewLocale.html.*\Z"
			access="CAN_VIEW_page_i18n_addNewLocale" />


		<intercept-url pattern="\A/security/editSecurity.html.*\Z"
			access="CAN_VIEW_page_security_editSecurity" />
		<!-- <intercept-url pattern="\A/security/changeUserApplication.html.*\Z" 
			access="CAN_VIEW_page_security_changeUserApplication"/> -->
		<intercept-url pattern="\A/security/addNewRole.html.*\Z"
			access="CAN_VIEW_page_security_addNewRole" />
		<intercept-url pattern="\A/security/addUserToRole.html.*\Z"
			access="CAN_VIEW_page_security_addUserToRole" />
		<intercept-url pattern="\A/security/userDetails.html.*\Z"
			access="CAN_VIEW_page_security_userDetails" />
		<intercept-url pattern="\A/security/roleDetails.html.*\Z"
			access="CAN_VIEW_page_security_roleDetails" />
		<intercept-url pattern="\A/security/updateRole.html.*\Z"
			access="CAN_VIEW_page_security_updateRole" />
			
			
		<intercept-url pattern="\A/attendance/dashboard.html.*\Z"
			access="CAN_VIEW_all_dashboard" />
		<intercept-url pattern="\A/attendance/qualificationView.html.*\Z"
			access="CAN_VIEW_all_qualification" />
			<intercept-url pattern="\A/attendance/qualificationForm.html.*\Z"
			access="CAN_VIEW_all_qualification" />
		<intercept-url pattern="\A/attendance/departmentView.html.*\Z"
			access="CAN_VIEW_all_department" />
			<intercept-url pattern="\A/attendance/departmentForm.html.*\Z"
			access="CAN_VIEW_all_department" />
		<intercept-url pattern="\A/attendance/titleView.html.*\Z"
			access="CAN_VIEW_all_titles" />
			<intercept-url pattern="\A/attendance/titleForm.html.*\Z"
			access="CAN_VIEW_all_titles" />
		<intercept-url pattern="\A/attendance/empBasicView.html.*\Z"
			access="CAN_VIEW_all_empbasic" />
		<intercept-url pattern="\A/attendance/empBasicForm.html.*\Z"
			access="CAN_VIEW_all_empbasic" />
		<intercept-url pattern="\A/attendance/vacRuleForm.html.*\Z"
			access="CAN_VIEW_all_vacrule" />
			<intercept-url pattern="\A/attendance/publicLeavesForm.html.*\Z"
			access="CAN_VIEW_all_publicleaves" />
		<intercept-url pattern="\A/attendance/vacationView.html.*\Z"
			access="CAN_VIEW_all_vacations" />
			<intercept-url pattern="\A/attendance/vacationForm.html.*\Z"
			access="CAN_VIEW_all_vacations" />
		<intercept-url pattern="\A/attendance/workperiodView.html.*\Z"
			access="CAN_VIEW_all_workperiods" />
		<intercept-url pattern="\A/attendance/workperiodForm.html.*\Z"
			access="CAN_VIEW_all_workperiods" />
		<intercept-url pattern="\A/attendance/triggerVacBalanceView.html.*\Z"
			access="CAN_VIEW_all_preparevacbalance" />
			
		<intercept-url pattern="\A/attendance/empWorkPeriodForm.html.*\Z"
			access="CAN_VIEW_all_empworkperiod" />
		<intercept-url pattern="\A/attendance/triggerAttendAnalysisView.html.*\Z"
			access="CAN_VIEW_all_prepareattendanceanalysis" />

		<intercept-url pattern="\A/stores/storesAdminBranches.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminBranches" />
		<intercept-url pattern="\A/stores/codesDivisionForm.html.*\Z"
			access="CAN_VIEW_page_stores_codesDivisionForm" />
		<intercept-url pattern="\A/stores/storesAdminGroupf.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminGroupf" />
		<intercept-url pattern="\A/stores/basicGroupForm.html.*\Z"
			access="CAN_VIEW_page_stores_basicGroupForm" />
		<intercept-url pattern="\A/stores/addBranch.html.*\Z"
			access="CAN_VIEW_page_stores_addBranch" />
		<intercept-url pattern="\A/stores/storesAdminStores.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminStores" />
		<intercept-url pattern="\A/stores/storesAdminEditStores.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditStores" />
		<intercept-url pattern="\A/stores/storesAdminGroupTypes.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminGroupTypes" />
		<intercept-url pattern="\A/stores/storesAdminEditGroupType.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditGroupType" />
		<intercept-url pattern="\A/stores/storesAdminCustomers.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminCustomers" />
		<intercept-url pattern="\A/stores/storesAdminEditCustomer.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditCustomer" />
		<intercept-url pattern="\A/stores/storesAdminAgents.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminAgents" />
		<intercept-url pattern="\A/stores/storesAdminEditAgent.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditAgent" />
		<intercept-url pattern="\A/stores/storesAdminVendors.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminVendors" />
		<intercept-url pattern="\A/stores/storesAdminEditVendors.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditVendors" />
		<intercept-url pattern="\A/stores/storesAdminSalesRep.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminSalesRep" />
		<intercept-url pattern="\A/stores/storesAdminEditSalesRep.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditSalesRep" />
		<intercept-url pattern="\A/stores/storesAdminPersons.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminPersons" />
		<intercept-url pattern="\A/stores/storesAdminEditPersons.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditPersons" />
		<intercept-url pattern="\A/stores/storesAdminItemData.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminItemData" />
		<intercept-url pattern="\A/stores/storesAdminEditItemData.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditItemData" />
		<intercept-url pattern="\A/stores/storesAdminBasicUnit.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminBasicUnit" />
		<intercept-url pattern="\A/stores/storesAdminEditBasicUnit.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditBasicUnit" />
		<intercept-url pattern="\A/stores/storesAdminEditFirstBalanceStore.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditFirstBalanceStore" />
		<intercept-url pattern="\A/stores/storesAdminContractors.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminContractors" />
		<intercept-url pattern="\A/stores/storesAdminEditContractor.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditContractor" />
		<intercept-url pattern="\A/stores/itemsMainGroupDescription.html.*\Z"
			access="CAN_VIEW_page_stores_itemsMainGroupDescription" />
		<intercept-url pattern="\A/stores/storesAdminStoreTrnsDefs.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminStoreTrnsDefs" />
		<intercept-url pattern="\A/stores/storesAdminEditStoreTrnsDef.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditStoreTrnsDef" />
		<intercept-url pattern="\A/stores/storesAdminEditStoreTrnsDefSpec.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditStoreTrnsDefSpec" />
		<intercept-url pattern="\A/stores/storesAdminEditStoreTrnsDefTax.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditStoreTrnsDefTax" />
		<intercept-url pattern="\A/stores/storesAdminListStoreTransaction.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminListStoreTransaction" />
		<intercept-url pattern="\A/stores/storesAdminEditStoreTransaction.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditStoreTransaction" />
		<intercept-url pattern="\A/stores/storesAdminPaletteNumber.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminPaletteNumber" />
		<intercept-url pattern="\A/stores/storesAdminEditPaletteNumber.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditPaletteNumber" />
		<intercept-url pattern="\A/stores/storesAdminRoomMeasures.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminRoomMeasures" />
		<intercept-url pattern="\A/stores/storesAdminEditRoomMeasures.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditRoomMeasures" />
		<intercept-url pattern="\A/stores/storesAdminCostCenter.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminCostCenter" />
		<intercept-url pattern="\A/stores/storesAdminEditCostCenter.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditCostCenter" />
		<intercept-url pattern="\A/stores/storesCreateInvoices.html.*\Z"
			access="CAN_VIEW_page_stores_storesCreateInvoices" />
		<intercept-url pattern="\A/stores/storesAdminAddStoreTransaction.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminAddStoreTransaction" />
		<intercept-url pattern="\A/stores/storesCloseContract.html.*\Z"
			access="CAN_VIEW_page_stores_storesCloseContract" />
		<intercept-url pattern="\A/stores/storesExternalTransaction.html.*\Z"
			access="CAN_VIEW_page_stores_storesExternalTransaction" />
		<intercept-url pattern="\A/stores/storesAdminMultiPalette.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminMultiPalette" />
		<intercept-url pattern="\A/stores/storesRoomMeasuresReport.html.*\Z"
			access="CAN_VIEW_page_stores_storesRoomMeasuresReport" />
		<intercept-url pattern="\A/stores/storesChoseModule.html.*\Z"
			access="CAN_VIEW_page_stores_storesChoseModule" />
		<intercept-url pattern="\A/stores/storesAdminDependenceSpec.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminDependenceSpec" />
		<intercept-url pattern="\A/stores/storesExternalDependenceOn.html.*\Z"
			access="CAN_VIEW_page_stores_storesExternalDependenceOn" />
		<intercept-url pattern="\A/stores/storesExternalDependenceTo.html.*\Z"
			access="CAN_VIEW_page_stores_storesExternalDependenceTo" />
		<intercept-url pattern="\A/stores/storesAdminDBConnection.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminDBConnection" />
		<intercept-url pattern="\A/stores/storesAdminEditDBConnection.html.*\Z"
			access="CAN_VIEW_page_stores_storesAdminEditDBConnection" />

		<!-- GL -->
		<intercept-url pattern="\A/gl/account.html.*\Z" access="CAN_VIEW_page_account" />
		<intercept-url pattern="\A/gl/accountForm.html.*\Z"
			access="CAN_VIEW_page_accountForm" />
		<intercept-url pattern="\A/gl/accountTypeForm.html.*\Z"
			access="CAN_VIEW_page_accountTypeForm" />
		<intercept-url pattern="\A/gl/currency.html.*\Z" access="CAN_VIEW_page_currency" />
		<intercept-url pattern="\A/gl/currencyForm.html.*\Z"
			access="CAN_VIEW_page_currencyForm" />
		<intercept-url pattern="\A/gl/financialPeriod.html.*\Z"
			access="CAN_VIEW_page_financialPeriod" />
		<intercept-url pattern="\A/gl/financialPeriodForm.html.*\Z"
			access="CAN_VIEW_page_financialPeriodForm" />
		<intercept-url pattern="\A/gl/docType.html.*\Z" access="CAN_VIEW_page_docType" />
		<intercept-url pattern="\A/gl/docTypeForm.html.*\Z"
			access="CAN_VIEW_page_docTypeForm" />
		<intercept-url pattern="\A/gl/masterBudget.html.*\Z"
			access="CAN_VIEW_page_masterBudget" />
		<intercept-url pattern="\A/gl/masterBudgetForm.html.*\Z"
			access="CAN_VIEW_page_masterBudgetForm" />
		<intercept-url pattern="\A/gl/masterTransactionForm.html.*\Z"
			access="CAN_VIEW_page_masterTransaction" />
		<intercept-url pattern="\A/gl/repeatableMasterTransactionForm.html.*\Z"
			access="CAN_VIEW_page_repeatableMasterTransactionForm" />
		<intercept-url pattern="\A/gl/searchRepeatableForm.html.*\Z"
			access="CAN_VIEW_page_searchRepeatableForm" />
		<intercept-url pattern="\A/gl/activateRepeatableTransactionForm.html.*\Z"
			access="CAN_VIEW_page_activateRepeatableTransact" />
		<intercept-url pattern="\A/gl/searchUnpostedTransaction.html.*\Z"
			access="CAN_VIEW_page_searchUnpostedTransaction" />
		<intercept-url pattern="\A/gl/searchTransaction.html.*\Z"
			access="CAN_VIEW_page_searchTransaction" />
		<intercept-url pattern="\A/gl/accountStatusReport.html.*\Z"
			access="CAN_VIEW_page_accountStatusReport" />
		<intercept-url pattern="\A/gl/accountTransactionsReport.html.*\Z"
			access="CAN_VIEW_page_accountTransactionsReport" />
		<intercept-url pattern="\A/gl/transactionDetails.html.*\Z"
			access="CAN_VIEW_page_transactionDetails" />

		<intercept-url pattern="\A/gl/suspendTransaction.html.*\Z"
			access="CAN_VIEW_page_suspendTransaction" />
		<intercept-url pattern="\A/gl/financialYear.html.*\Z"
			access="CAN_VIEW_page_financialYear" />
		<intercept-url pattern="\A/gl/financialYearForm.html.*\Z"
			access="CAN_VIEW_page_financialYearForm" />
		<intercept-url pattern="\A/gl/reports.html.*\Z" access="CAN_VIEW_page_reports" />
		<intercept-url pattern="\A/gl/addDetailedBudgetManually.html.*\Z"
			access="CAN_VIEW_page_addDetailedBudgetManually" />
		<intercept-url pattern="\A/gl/addEstimatedBalance.html.*\Z"
			access="CAN_VIEW_page_addEstimatedBalance" />
		<!-- ///////////////////////////////////////////////// -->
		
			<intercept-url pattern="\A/security/defaultPage.html.*\Z"
			access="CAN_VIEW_page_RequestsAproval_generalEmployee" />
		<!-- RequestsApproval -->
		<intercept-url pattern="\A/requestsApproval/loginUsersRequestsView.html.*\Z"
			access="CAN_VIEW_page_RequestsAproval_generalEmployee" />
		<intercept-url pattern="\A/requestsApproval/empRequestsReportsForm.html.*\Z"
			access="CAN_VIEW_page_requestsApproval" />
		<intercept-url pattern="\A/requestsApproval/requestsApprovalForm.html.*\Z"
			access="CAN_VIEW_page_requestsApproval" />
		<intercept-url pattern="\A/requestsApproval/loginUsersRequestsForm.html.*\Z"
			access="CAN_VIEW_page_RequestsAproval_generalEmployee" />
		<intercept-url pattern="\A/requestsApproval/reports.html.*\Z"
			access="CAN_VIEW_page_requestsApproval" />
		<intercept-url pattern="\A/requestsApproval/accessLevelsForm.html.*\Z"
			access="CAN_VIEW_page_approvement" />
		<intercept-url pattern="\A/requestsApproval/empReqTypeGroupForm.html.*\Z"
			access="CAN_VIEW_page_approvement" />
		<intercept-url pattern="\A/requestsApproval/empGroupsView.html.*\Z"
			access="CAN_VIEW_page_approvement" />
		<intercept-url pattern="\A/requestsApproval/annualVacLimitSetting.html.*\Z"
			access="CAN_VIEW_page_approvement" />
		
		<intercept-url pattern="/requestsApproval/loginUsersRequestsForm.html/vacInfo.*\Z"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
		
		
		<intercept-url pattern="/requestsApproval/attendanceRequestForm.html.*\Z"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			
		<intercept-url pattern="/common/changeApplication.html?aaplication=.*\Z"
			access="hasRole('CAN_VIEW_page_RequestsAproval_generalEmployee')" />
			
		<intercept-url pattern="/attendance/vacRuleForm.html.*\Z"
			access="hasRole('CAN_VIEW_page_approvement')" />
			
			<intercept-url pattern="/attendance/ajax-drawAbsenceAttendanceByDepartment"
			access="hasRole('CAN_VIEW_page_approvement')" />
			
			<intercept-url pattern="/attendance/qualificationForm.html.*\Z"
			access="hasRole('CAN_VIEW_all_qualification')" />
			
	</http>

	<global-method-security pre-post-annotations="enabled" />



	<beans:bean name="jacksonObjectMapper"
		class="org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean">
	</beans:bean>
	<beans:bean id="jsonConverter"
		class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter">
		<beans:property name="prefixJson" value="false" />
		<beans:property name="supportedMediaTypes" value="application/json" />
		<beans:property name="objectMapper">
			<beans:bean class="com.fasterxml.jackson.databind.ObjectMapper">
				<beans:property name="serializationInclusion" value="NON_NULL" />
			<!-- 	<beans:property name="adjust_dates_to_context_time_zone" value="false"/> -->
			</beans:bean>
		</beans:property>
	</beans:bean>

	<beans:bean id="restAuthenticationEntryPoint"
		class="com._4s_.restServices.entrypoint.RestAuthenticationEntryPoint">
		<beans:property name="jsonConverter" ref="jsonConverter" />
	</beans:bean>


	<beans:bean id="exceptionControllerAdvice"
		class="com._4s_.restServices.endpoint.ExceptionControllerAdvice">
		<beans:property name="jsonConverter" ref="jsonConverter" />
	</beans:bean>

	<beans:bean id="mySuccessHandler"
		class="com._4s_.restServices.entrypoint.MySavedRequestAwareAuthenticationSuccessHandler" />
	<beans:bean id="myFailureHandler"
		class="com._4s_.restServices.entrypoint.AuthFailureHandler" />
	<beans:bean id="myLogoutHandler"
		class="com._4s_.restServices.entrypoint.CustomLogoutSuccessHandler" />




	<beans:bean id="authenticationFilter"
		class="org.springframework.security.web.authentication.www.BasicAuthenticationFilter">
		<beans:constructor-arg ref="authenticationManager" />
		<beans:constructor-arg ref="restAuthenticationEntryPoint" />
		<beans:property name="rememberMeServices" ref="rememberMeServices" />
		<!-- <beans:property name="authenticationSuccessHandler" ref="mySuccessHandler" 
			/> -->
	</beans:bean>


	<authentication-manager alias="authenticationManager">
		 <authentication-provider ref="rememberMeAuthenticationProvider">
        </authentication-provider>
		<authentication-provider>
			<jdbc-user-service data-source-ref="dataSource"
				users-by-username-query="SELECT userName, password,1 as enabled FROM security_users WHERE userName=?"
				authorities-by-username-query="select distinct userName,permessionname from
				security_users,security_user_roles,security_role_permissions,
				security_permissions,security_roles
				where security_users.id=security_user_roles.users and
				security_user_roles.role=security_roles.id and
				security_role_permissions.role=security_roles.id and
				security_role_permissions.permission=security_permissions.id
				and selected=1 and security_users.isActive=1 and (end_serv is null or (END_SERV >= ${hibernate.systemDate})) and userName=?" />
			<password-encoder ref="encoder" />
		</authentication-provider>
	</authentication-manager>

<beans:bean id="encoder" 
  class="org.springframework.security.crypto.password.NoOpPasswordEncoder">
</beans:bean>
	<beans:bean id="filterChainProxy"
	class="org.springframework.security.web.FilterChainProxy">
	<filter-chain-map>
		<filter-chain pattern="\A/security/login.html"
			filters="authenticationFilter" />
	</filter-chain-map>
</beans:bean> 


	<beans:bean id="myVoter" class="com._4s_.security.service.MyVoter">
		<beans:property name="rolePrefix">
			<beans:value>My_</beans:value>
		</beans:property>
	</beans:bean>
	<beans:bean id="roleVoter"
		class="org.springframework.security.access.vote.RoleVoter">
		<beans:property name="rolePrefix" value="CAN_" />
	</beans:bean>

	<beans:bean id="accessDecisionManager"
		class="org.springframework.security.access.vote.AffirmativeBased">
		<beans:constructor-arg>
			<beans:list>
				<beans:bean
					class="org.springframework.security.access.vote.AuthenticatedVoter" />
				<beans:bean class="org.springframework.security.access.vote.RoleVoter">
					<beans:property name="rolePrefix" value="CAN_" />
				</beans:bean>
				<beans:bean
					class="org.springframework.security.web.access.expression.WebExpressionVoter" />
			</beans:list>
		</beans:constructor-arg>
		<beans:property name="allowIfAllAbstainDecisions">
			<beans:value>true</beans:value>
		</beans:property>
	</beans:bean>
	<beans:bean id="myAccessDecisionManager"
		class="org.springframework.security.access.vote.AffirmativeBased">
		<beans:constructor-arg name="decisionVoters">
			<beans:list>
				<beans:ref bean="myVoter" />
			</beans:list>
		</beans:constructor-arg>
		<beans:property name="allowIfAllAbstainDecisions">
			<beans:value>true</beans:value>
		</beans:property>
	</beans:bean>
	<!-- <beans:bean id="accessDecisionManager" class="org.springframework.security.vote.AffirmativeBased"> 
		<beans:property name="allowIfAllAbstainDecisions" value="false"/> <beans:property 
		name="decisionVoters"> <beans:list> <beans:bean class="org.springframework.security.vote.RoleVoter"/> 
		<beans:bean class="org.springframework.security.vote.AuthenticatedVoter"/> 
		</beans:list> </beans:property> </beans:bean> <beans:bean id="filterInvocationInterceptor" 
		class="org.springframework.security.intercept.web.FilterSecurityInterceptor"> 
		<beans:property name="authenticationManager" ref="authenticationManager"/> 
		<beans:property name="accessDecisionManager" ref="accessDecisionManager"/> 
		<beans:property name="objectDefinitionSource" ref="secureResourceFilter" 
		/> </beans:bean> -->
	<!-- <beans:bean id="secureResourceFilter" class="org.security.SecureFilter.MySecureResourceFilter" 
		/> -->




	<!-- Spring Security 3.1.7 -->
	<!-- <beans:bean id="basicProcessingFilterEntryPoint" class="org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint"> 
		<property name="realmName" value="My Realm" /> </beans:bean> <beans:bean 
		id="httpSessionContextIntegrationFilter" class="org.springframework.security.web.context.SecurityContextPersistenceFilter"> 
		<beans:property name="forceEagerSessionCreation" value="false" /> </beans:bean> 
		<beans:bean id="authenticationManager" class="org.springframework.security.authentication.ProviderManager"> 
		<beans:property name="providers"> <beans:list> <ref bean="usernamePasswordAuthenticationProvider" 
		/> </beans:list> </beans:property> </beans:bean> <beans:bean id="roleVoter" 
		class="org.springframework.security.access.vote.RoleVoter"> <property name="rolePrefix" 
		value="" /> </beans:bean> -->
	<!-- <security:global-method-security pre-post-annotations="enabled"/> -->

	<!-- ///////////////////// -->

	<!-- ////////////////////////////////////////// -->


	<!-- Start Caching Beans -->

	<!-- <bean id="cacheManager" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean"/> 
		<bean id="userCacheBackend" class="org.springframework.cache.ehcache.EhCacheFactoryBean"> 
		<property name="cacheManager"> <ref local="cacheManager"/> </property> <property 
		name="cacheName"> <value>userCache</value> </property> <property name="eternal"> 
		<value>true</value> </property> </bean> <bean id="userCache" class="org.acegisecurity.providers.dao.cache.EhCacheBasedUserCache"> 
		<property name="cache"><ref local="userCacheBackend"/></property> </bean> -->
	<!-- End Caching Beans -->

</beans:beans>